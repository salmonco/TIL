## 1. 활동 내용
- Axios를 이용한 서버 통신 개념 학습
- React-Router 학습
- JWT 기반 사용자 인증 구현
- 소셜 로그인 구현

## 2. 이슈
소셜 로그인을 구현함에 있어서, 서버에서 보내는 데이터를 프론트에서 받기 위한 방법에 대한 고민이 있었다.

**상황**
- **프론트** : 카카오로 로그인하기 버튼을 눌렀을 때, 카카오 로그인 url로 단순 링크를 이동시켰다.  
- **서버** : 카카오 로그인 url에는 쿼리 파라미터로 redirect_uri가 포함되어 있는데, 이 redirect_uri를 컨트롤러에서 맵핑한다. 그리고 사용자가 로그인한 정보를 바탕으로 생성된 code, access key 정보를 처리한 후 JWT 토큰 및 사용자 개인 정보를 담아 프론트에게 응답을 보낸다.  
- **(이슈) 프론트** : 서버에서 보낸 데이터를 받아오지 못했다.

**원인**  
프론트에서 카카오 로그인 url로 단순 링크를 이동시킨 것은 Axios 요청을 보낸 것이 아니므로, 애초에 요청을 하지 않았으니 서버로부터 응답도 받을 수 없다.

**해결 방법1**  
기존 상황에서 약간 변형한 것인데, 서버가 응답을 보낼 때 url 파라미터를 통해 데이터를 담아 프론트로 redirect 되게끔하는 방법이다.
- 서버에서 JWT 토큰 및 사용자 개인 정보를 담아 프론트에게 응답을 보낼 때, 일반적인 방법으로 ResponseEntity에 담아 응답을 보내는 것이 아닌, 쿼리 파라미터를 통해 데이터를 담아 프론트로 redirect 시킨다.

문제점으로는, url상에 JWT 토큰 및 사용자 개인 정보가 노출되는 것이므로 보안상 안 좋다.  
팀원 분께서 말씀해주시길, 기본적으로 리다이렉트는 GET 요청으로 보내지는 거라, 리다이렉트와 함께 데이터 전송을 원할 시 HTTP Body가 존재하지 않기 때문에 무조건 url 파라미터로 이동시켜야 한다고 한다.  
따라서 url 쿼리 파라미터를 숨길 수 있는 방법을 찾아봐야 할텐데, 팀원 분께서 찾아본 결과 Spring에서 쿼리 파라미터를 숨길 수 있는 방법이 마땅치 않은 것 같다.

**해결 방법2**  
카카오 로그인 url에 포함되어 있는 redirect_uri를 프론트(ex. localhost:3000/kakaoLogin)로 설정하여, 프론트에서 code 정보를 담아 서버로 Axios 요청을 보내 데이터를 받아오는 방법이다.
- **프론트** : 카카오 로그인하기 버튼을 클릭했을 때 window.location.href로 카카오 로그인 url로 단순 링크를 이동시킨다.  
redirect_uri에 의해 redirect된 페이지(ex. kakaoLogin.js)에서, url에 포함되어 있는 code(인가코드)를 담아 서버에 Axios 요청한다.
- **서버** : 요청받은 code로 JWT 토큰 생성 및 사용자 개인 정보를 담아 프론트로 응답을 보낸다.
- **프론트** : 서버에서 보낸 데이터를 받아온다.

인터넷을 찾아보니 보통 방법2로 소셜 로그인을 구현하는 것 같다.  
한편, 팀원 분께서 말씀해주시길 카카오와 네이버 모두 code, access key 정보는 사용자가 로그인한 정보를 바탕으로 생성되기 때문에 서버에서 처리하도록 요구하고 있다고 한다.  
이 점을 고려한다면 방법1을 생각해볼 수 있다. 그렇지만 방법1은 보안상 좋지 않기에 방법2로 많이들 구현하는 것 같다.

## 3. 새로 배운 내용
`useState` : 컴포넌트 내 상태를 관리할 때 사용

`useState` vs `useRef`

- state가 화면에 렌더링될 것이라면 useState를, 아니라면 useRef로 간단하게 가능하다.
#
`useEffect` : 기본적으로, 컴포넌트가 처음 마운트될 때 useEffect 내 함수를 호출하고, 컴포넌트가 언마운트될 때 cleanup 함수를 호출한다.

**useEffect 내 함수가 호출되는 시점**
- deps가 빈배열인 경우, 컴포넌트가 처음 마운트될 때만 useEffect 내 함수 호출
- deps에 의존 값이 있는 경우, 의존 값이 업데이트 됐을 때마다 useEffect 내 함수 호출
- deps 파라미터를 생략한 경우, 그냥 컴포넌트가 리렌더링될 때마다 useEffect 내 함수 호출
#
`Axios` 라이브러리 : API를 호출하기 위함
```javascript
import axios from 'axios';

/* 데이터 조회 : 파라미터에는 API 주소를 넣음 */
const getTest = async () => {
  try {
    await axios
      .get('/users/1')
      .then(res => {
        console.log(res.data);
      });
  } catch (e) {
    console.log(e);
  }
}

/* 데이터 등록 : 두 번째 파라미터에 등록하고자 하는 정보를 넣을 수 있음 */
const postTest = async () => {
  try {
    await axios
      .post('/users', {
        username: 'blabla',
        name: 'blabla',
      })
      .then(res => {
        console.log(res.data);
      });
  } catch (e) {
    console.log(e);
  }
}
```
#
`React-Router` 라이브러리 : 리액트에서 SPA (Single Page Application)를 만들기 위해 가장 많이 사용되는 라이브러리다.  
기존 웹 사이트에서 가능하던 url path를 통한 라우팅이 가능해짐과 동시에 페이지의 동작은 SPA를 따르게 된다.
- `<Route path="/about" component={About}>`  
참고로, Route 태그에 exact={true} 속성을 주면 자신의 path에 정확하게 위치해야만 자신의 컴포넌트가 render된다.
- `<Link to="/about">About</Link>`
- `<Router>` : <Route>와 <Link> 컴포넌트는 DOM 트리 상에서 항상 <Router>를 공통 상위 컴포넌트로 가져야 한다.
#
`Link` vs `useNavigate`

- `Link` : 클릭 시 바로 이동하는 로직 구현 시에 사용
- `useNavigate` : 페이지 전환 시 추가로 처리해야 하는 로직이 있을 경우 사용
#
`recoil-persist` : 새로고침해도 데이터가 날라가지 않도록 localstorage에 저장하게끔 하는 라이브러리다.

## 4. 회고
React를 처음 접하고 학습하는 것부터 시작해서 소셜 로그인을 구해보았는데, 여러 이슈들도 있었지만 이를 통해 더 많이 생각하고 배울 수 있었던 것 같다.  
이외에도 서버와 API 연동을 하면서 CORS 문제가 발생해 해결을 위해 많은 시간을 투자했는데, 이런 경험 또한 소중하다고 생각하게 되었다.  
사실 나는 팀 프로젝트도 처음이고 React란 라이브러리를 사용해서 웹을 개발하는 것도 처음이다.  
그렇지만 혼자 하는 것이 아닌 팀 프로젝트다 보니 팀원분들에게 많은 도움을 받을 수 있었다.  
개인적으로도 파란학기 프로젝트가 계획대로 진행될 수 있도록 적지 않은 시간을 투자하며 노력하고자 한다.  
사실 파란학기라는 게 숙제처럼 느껴지기 보단 스스로 배우고 결과물을 만드는 것이 재밌기도 하다. (지금까진 그렇다.)

## 5. 향후 계획
- state와 props 개념 학습
- 데이터 통신을 위한 Serivce 만들기
